angular.module('tags.services', ['tags.models'])

    .factory('TagService', function (BlogImage, $state) {
        function Service() {

            var id = $state.params.postId

            //image uploader
            this.uploader = function (success) {
                return {
                    options: {
                        url: 'api/admin/blog/' + id + '/image',
                        clickable: true,
                        maxFileSize: 10
                    },
                    handlers: {
                        success: success
                    }
                }
            };

            this.update = function (post, img, translations) {
                img.translations = translations;
                img.postId = post.id;

                image = new BlogImage(img);
                return image.$update();
            };

            this.delete = function (post, imageId, success) {
                return BlogImage.delete({
                    postId: post.id,
                    imageId: imageId
                }, success);
            };
        }

        return new Service();
    });


angular.module('tags.models', ['ngResource'])

    .factory('Tag', function ($resource) {

        var placeholders = {
            tagId: '@id',
        };

        return $resource('api/tag/:tagId', placeholders, {
            query: {isArray: false},
            update: {
                method: 'PUT'
            }
        });
    });



angular.module('tags', ['tags.models', 'tags.services']);